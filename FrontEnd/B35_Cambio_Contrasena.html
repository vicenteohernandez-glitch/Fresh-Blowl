<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Cambiar Contrase√±a - Fresh Bowl</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.container {
  background: white;
  padding: 35px;
  border-radius: 16px;
  width: 100%;
  max-width: 400px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
}

h2 { text-align: center; color: #2e7d32; margin-bottom: 25px; }

.form-group { margin-bottom: 18px; }

label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  color: #333;
  font-size: 0.9em;
}

input {
  width: 100%;
  padding: 14px;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 1em;
}
input:focus { outline: none; border-color: #27ae60; }

.btn {
  width: 100%;
  padding: 14px;
  border: none;
  border-radius: 10px;
  font-size: 1em;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}
.btn-primary {
  background: linear-gradient(135deg, #27ae60, #2ecc71);
  color: white;
}
.btn-secondary { background: #f5f5f5; color: #333; }

.mensaje {
  text-align: center;
  padding: 12px;
  border-radius: 8px;
  margin-top: 15px;
  display: none;
}
.mensaje.error { display: block; background: #ffebee; color: #c62828; }
.mensaje.success { display: block; background: #e8f5e9; color: #2e7d32; }

.links { text-align: center; margin-top: 20px; }
.links a { color: #27ae60; text-decoration: none; }

.requirements {
  background: #f5f5f5;
  padding: 12px;
  border-radius: 8px;
  font-size: 0.85em;
  color: #666;
  margin-bottom: 15px;
}
.requirements li { margin: 5px 0; }
</style>
</head>
<body>

<div class="container">
  <h2>üîê Cambiar Contrase√±a</h2>
  
  <div class="requirements">
    <strong>Requisitos:</strong>
    <ul style="margin: 5px 0; padding-left: 20px;">
      <li>M√≠nimo 6 caracteres</li>
      <li>Las contrase√±as deben coincidir</li>
    </ul>
  </div>

  <div class="form-group">
    <label for="actual">Contrase√±a actual</label>
    <input type="password" id="actual" placeholder="Tu contrase√±a actual">
  </div>

  <div class="form-group">
    <label for="nueva">Nueva contrase√±a</label>
    <input type="password" id="nueva" placeholder="M√≠nimo 6 caracteres">
  </div>

  <div class="form-group">
    <label for="confirmar">Confirmar nueva contrase√±a</label>
    <input type="password" id="confirmar" placeholder="Repite la nueva contrase√±a">
  </div>

  <button class="btn btn-primary" id="cambiar">üîÑ Actualizar Contrase√±a</button>
  <button class="btn btn-secondary" onclick="location.href='B33_ver_perfil.html'">‚Üê Volver al perfil</button>

  <div class="mensaje" id="mensaje"></div>

  <div class="links">
    <a href="B3_Recuperar_Contrase√±a.html">¬øOlvidaste tu contrase√±a?</a>
  </div>
</div>

<script src="api.js"></script>
<script>
const usuario = JSON.parse(localStorage.getItem("usuarioFB") || "null");

if (!usuario) {
  alert("Debes iniciar sesi√≥n");
  location.href = "B4_Inicio_Sesion.html";
}

function mostrarMensaje(texto, tipo) {
  const msg = document.getElementById("mensaje");
  msg.textContent = texto;
  msg.className = "mensaje " + tipo;
}

document.getElementById("cambiar").addEventListener("click", async () => {
  const actual = document.getElementById("actual").value;
  const nueva = document.getElementById("nueva").value;
  const confirmar = document.getElementById("confirmar").value;

  if (!actual || !nueva || !confirmar) {
    mostrarMensaje("‚ö†Ô∏è Completa todos los campos", "error");
    return;
  }

  if (nueva.length < 6) {
    mostrarMensaje("‚ö†Ô∏è La contrase√±a debe tener al menos 6 caracteres", "error");
    return;
  }

  if (nueva !== confirmar) {
    mostrarMensaje("‚ö†Ô∏è Las contrase√±as no coinciden", "error");
    return;
  }

  // Demo: simular cambio de contrase√±a
  // En producci√≥n esto llamar√≠a a una API real
  try {
    // Simular delay de API
    await new Promise(resolve => setTimeout(resolve, 800));
    
    mostrarMensaje("‚úÖ Contrase√±a actualizada correctamente", "success");
    
    // Limpiar campos
    document.getElementById("actual").value = "";
    document.getElementById("nueva").value = "";
    document.getElementById("confirmar").value = "";
    
  } catch (error) {
    mostrarMensaje("Error al cambiar contrase√±a", "error");
  }
});
</script>
</body>
</html>
